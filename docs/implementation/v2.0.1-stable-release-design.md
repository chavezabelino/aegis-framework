<!--
# ðŸŽ¯ Aegis Framework v2.1.0: Stable Release System Design

@aegisFrameworkVersion: 2.4.0
@intent: Design specification for stable release system and packaged distribution
@context: Enhancement from v2.0.0-alpha to v2.1.0 with production-ready packaging
-->

# ðŸŽ¯ Aegis Framework v2.1.0: Stable Release System Design

## ðŸ“‹ Enhancement Overview

**Objective__: Transform Aegis Framework from alpha development to production-ready stable releases with packaged
distribution.

**Current State__: v2.0.0-alpha-dev (single command hydration implemented)  
**Target State__: v2.1.0-stable (stable release system with packaged distribution)

## ðŸ—ï¸ Solution Architecture

### __1. Release Management System**

#### __Version Strategy**

```text
Stable Releases:    v2.1.0, v2.0.2, v2.0.3...
Alpha Releases:     v2.1.0-alpha.1, v2.1.0-alpha.2...
Beta Releases:      v2.1.0-beta.1, v2.1.0-beta.2...
Release Candidates: v2.1.0-rc.1, v2.1.0-rc.2...
```text

#### __Release Channels**

- __`stable`__: Production-ready releases
- __`beta`__: Feature-complete pre-releases
- __`alpha`__: Development releases with new features
- __`nightly`__: Automated daily builds from main branch

### __2. Packaged Distribution System**

#### __Distribution Formats**

1. __Standalone CLI Package__: Self-contained hydration tool
2. __Framework Library Package__: Full framework for customization
3. __Docker Container__: Containerized deployment
4. __GitHub Releases__: Versioned downloadable packages

#### __Package Contents**

```text
Aegis-framework-v2.1.0-stable/
â”œâ”€â”€ bin/
â”‚   â”œâ”€â”€ Aegis-hydrate           # Main CLI tool
â”‚   â”œâ”€â”€ Aegis-conductor         # Governance automation
â”‚   â””â”€â”€ Aegis-validate          # Validation tools
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ framework/              # Core framework files
â”‚   â”œâ”€â”€ templates/              # Blueprint templates
â”‚   â””â”€â”€ tools/                  # Validation and tooling
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ getting-started.md      # Quick start guide
â”‚   â”œâ”€â”€ API-reference.md        # CLI documentation
â”‚   â””â”€â”€ examples/               # Usage examples
â”œâ”€â”€ package.JSON                # npm package configuration
â”œâ”€â”€ VERSION                     # Release version
â”œâ”€â”€ CHANGELOG.md               # Release notes
â”œâ”€â”€ LICENSE                    # License information
â””â”€â”€ README.md                  # Package overview
```text

### __3. Build and Release Pipeline**

#### __GitHub Actions Workflow**

```yaml
# .GitHub/workflows/release.yml
name: Release
on:
  push:
    tags:
      - "v*"
  workflow_dispatch:
    inputs:
      release_type:
        description: "Release type"
        required: true
        default: "patch"
        type: choice
        options:
          - patch
          - minor
          - major
          - prerelease
```text

#### __Build Process**

1. __Pre-build Validation__: Constitutional compliance, test suite, lint checks
2. __Package Generation__: Create npm-compatible packages with dependency declarations
3. __npm Package Creation__: Generate packages following Node.js CLI standards
4. __Docker Image__: Build containerized version (only place where bundling is appropriate)
5. __Release Artifacts__: Upload source tarballs to GitHub Releases
6. __npm Publishing__: Publish to npm registry with automatic dependency resolution

**âš ï¸ Design Evolution Note__: Initial design incorrectly suggested dependency bundling. Following user feedback
(EVS-2025-08-07-008), corrected to industry-standard npm dependency declaration approach.

### __4. Installation Methods**

#### __npm Installation (Recommended)**

```bash
# Prerequisites: Node.js >= 18.0.0, npm >= 8.0.0

# Install globally - npm handles all dependencies automatically
npm install -g @Aegis-framework/CLI@2.1.0

# Use immediately
Aegis-hydrate /path/to/your/project
Aegis-conductor init
```text

#### __From Source (For Development/Customization)**

```bash
# Prerequisites: Node.js >= 18.0.0, npm >= 8.0.0, git

# Clone and install
git clone https://github.com/aegis-framework/aegis-framework.git
cd Aegis-framework
npm install  # Installs all dependencies automatically

# Use directly
./CLI/Aegis-hydrate.ts /path/to/project
```text

#### __Docker (For Isolated Environments)**

```bash
# Prerequisites: Docker >= 20.0.0

# Run hydration (dependencies bundled in container)
docker run --rm -v $(pwd):/workspace Aegis-framework/CLI:2.1.0 hydrate /workspace
```text

## ðŸ”§ Implementation Plan

### __Phase 1: Version Management (Week 1)**

#### __1.1 Update Version System**

- Synchronize VERSION file and package.JSON
- Implement semantic versioning automation
- Create version validation tools

#### __1.2 Release Preparation Tools**

- Build script for package generation
- Automated changelog generation
- Release notes automation

### __Phase 2: Package Distribution (Week 2)**

#### __2.1 npm CLI Package (Corrected Approach)**

- Extract core CLI functionality to clean package structure
- Declare dependencies in package.JSON (industry standard)
- Create npm-compatible package following Node.js conventions
- __Evolution Note__: Removed incorrect bundling approach per EVS-2025-08-07-008

#### __2.2 Framework Library Package**

- Separate core framework from development files
- Create installable library package for customization
- Documentation for framework extension and modification

### __Phase 3: Release Automation (Week 3)**

#### __3.1 GitHub Actions Pipeline**

- Automated testing and validation
- Package building and artifact generation
- Release publishing automation

#### __3.2 Distribution Channels**

- npm package publishing
- GitHub Releases setup
- Docker Hub integration

### __Phase 4: Documentation & Testing (Week 4)**

#### __4.1 Installation Documentation**

- Getting started guides
- Installation methods documentation
- Migration guides from alpha versions

#### __4.2 Integration Testing**

- Test installation methods
- Validate package functionality
- End-to-end release workflow testing

## ðŸ“Š Success Metrics

### __Technical Metrics**

- Package size < 1MB for npm CLI package (achieved: 83KB)
- Installation time < 30 seconds via npm
- Zero dependency conflicts (npm handles resolution automatically)
- 100% functionality parity with development version

### __User Experience Metrics**

- One-command installation: `npm install -g @Aegis-framework/CLI`
- Quick start time: < 5 minutes from install to first hydration
- Clear upgrade path from any version
- Comprehensive documentation coverage

### __Release Quality Metrics**

- Automated testing coverage > 90%
- Zero critical bugs in stable releases
- Backward compatibility for CLI interface
- ConstitutionalConstitutional compliance maintained

## ðŸš€ Implementation Roadmap

| Week       | Focus              | Deliverables                                                 |
| ---------- | ------------------ | ------------------------------------------------------------ |
| __Week 1__ | Version Management | Version sync, release tools, changelog automation            |
| __Week 2__ | Package Creation   | Standalone CLI, library package, Docker image                |
| __Week 3__ | Release Pipeline   | GitHub Actions, npm publishing, artifact generation          |
| __Week 4__ | Testing & Docs     | Installation guides, integration testing, release validation |

**Timeline__: 4 weeks to v2.1.0-stable  
**Release Date__: September 4, 2025

## ðŸŽ¯ User Scenarios

### __Scenario 1: Quick Start User**

```bash
# Install globally
npm install -g @Aegis-framework/CLI

# Hydrate existing project
Aegis-hydrate /path/to/my/project
```text

### __Scenario 2: Custom Framework User**

```bash
# Clone and customize
git clone https://github.com/aegis-framework/aegis-framework.git
cd Aegis-framework

# Install dependencies
npm install

# Customize framework
# ... make modifications ...

# Build custom package
npm run build:package

# Use custom package
./dist/bin/Aegis-hydrate /path/to/project
```text

### __Scenario 3: Enterprise Docker User**

```bash
# Add to Dockerfile
FROM Aegis-framework/CLI:2.1.0 as Aegis
FROM node:18
COPY --from=Aegis /usr/local/bin/Aegis-* /usr/local/bin/

# Use in CI/CD
RUN Aegis-hydrate /workspace --auto-approve
```text

This design provides a comprehensive solution for stable releases and packaged distribution while maintaining the
framework's Constitutional governance principles and ensuring easy adoption across different user scenarios.

## ðŸ“š Design Evolution Notes

### __Dependency Strategy Correction (August 7, 2025)**

**Evolution Story__: EVS-2025-08-07-008 - Dependency Bundling Drift and Correction

**Original Design Issue__: Initial specification incorrectly suggested dependency bundling for "standalone" CLI
packages, which violated Node.js CLI distribution standards.

**User-Driven Correction__: Field user identified that dependencies should be prerequisites managed by npm, not bundled
files.

**Impact__:

- âœ… Reduced package size from 1MB+ to 83KB
- âœ… Aligned with industry standards (TypeScript, ESLint, Angular CLI)
- âœ… Simplified build process and maintenance
- âœ… Improved user experience with standard npm installation

**Key Learning__: User expertise in open source distribution > framework assumptions. Always validate against industry
standards before implementing custom solutions.
